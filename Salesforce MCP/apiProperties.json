{
  "properties": {
    "connectionParameters": {
      "instance": {
        "type": "string",
        "uiDefinition": {
          "displayName": "Salesforce Instance",
          "description": "Your Salesforce My Domain name (e.g., mycompany for mycompany.my.salesforce.com)",
          "tooltip": "Enter only the My Domain name, not the full URL",
          "constraints": {
            "required": "true"
          }
        }
      },
      "token": {
        "type": "oauthSetting",
        "oAuthSettings": {
          "identityProvider": "oauth2generic",
          "clientId": "[REPLACE_WITH_CLIENT_ID]",
          "scopes": ["api", "refresh_token"],
          "redirectMode": "Global",
          "redirectUrl": "https://global.consent.azure-apim.net/redirect",
          "properties": {
            "IsFirstParty": "False",
            "IsOnbehalfofLoginSupported": false
          },
          "customParameters": {
            "authorizationUrlTemplate": {
              "value": "https://login.salesforce.com/services/oauth2/authorize"
            },
            "authorizationUrlQueryStringTemplate": {
              "value": "response_type=code&client_id={ClientId}&redirect_uri={RedirectUrl}&state={State}&scope=api%20refresh_token"
            },
            "tokenUrlTemplate": {
              "value": "https://login.salesforce.com/services/oauth2/token"
            },
            "tokenBodyTemplate": {
              "value": "grant_type=authorization_code&code={Code}&redirect_uri={RedirectUrl}&client_id={ClientId}&client_secret={ClientSecret}"
            },
            "refreshUrlTemplate": {
              "value": "https://login.salesforce.com/services/oauth2/token"
            },
            "refreshBodyTemplate": {
              "value": "grant_type=refresh_token&refresh_token={RefreshToken}&client_id={ClientId}&client_secret={ClientSecret}"
            }
          }
        },
        "uiDefinition": {
          "displayName": "OAuth 2.0 Authentication",
          "description": "OAuth 2.0 authentication with Salesforce"
        }
      }
    },
    "policyTemplateInstances": [
      {
        "templateId": "setheader",
        "title": "Set Content-Type Header",
        "parameters": {
          "x-ms-apimTemplateParameter.name": "Content-Type",
          "x-ms-apimTemplateParameter.value": "application/json",
          "x-ms-apimTemplateParameter.existsAction": "skip",
          "x-ms-apimTemplate-policySection": "Request"
        }
      },
      {
        "templateId": "setheader",
        "title": "Set Accept Header",
        "parameters": {
          "x-ms-apimTemplateParameter.name": "Accept",
          "x-ms-apimTemplateParameter.value": "application/json",
          "x-ms-apimTemplateParameter.existsAction": "skip",
          "x-ms-apimTemplate-policySection": "Request"
        }
      },
      {
        "templateId": "dynamichosturl",
        "title": "Set Dynamic Host",
        "parameters": {
          "x-ms-apimTemplateParameter.urlTemplate": "https://@connectionParameters('instance').my.salesforce.com/services/data/v66.0"
        }
      }
    ],
    "iconBrandColor": "#00A1E0",
    "scriptOperations": ["InvokeMCP", "GetObjectSchema"],
    "capabilities": [],
    "publisher": "Salesforce",
    "stackOwner": "Salesforce"
  }
}
